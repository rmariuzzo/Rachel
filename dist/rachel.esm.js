function createApi(t){var e=t;return{list:function(t,n){return _list(t,_extends({},e,n))},get:function(t,n){return _get(t,_extends({},e,n))},post:function(t,n){return _post(t,_extends({},e,n))},put:function(t,n){return _put(t,_extends({},e,n))},del:function(t,n){return _del(t,_extends({},e,n))}}}function _list(t,e){if("string"!=typeof t)throw new Error("the path must be a string");return function(){return request(t,_extends({},e,{method:"GET"}))}}function _get(t,e){if("string"!=typeof t)throw new Error("the path must be a string");return function(e,n){request(t,_extends({},n,{method:"GET",id:e}))}}function _post(t,e){if("string"!=typeof t)throw new Error("the path must be a string");return function(e,n){request(t,_extends({},n,{method:"POST",data:e}))}}function _put(t,e){if("string"!=typeof t)throw new Error("the path must be a string");return function(e,n,r){request(t,_extends({},r,{method:"PUT",id:e,data:n}))}}function _del(t,e){if("string"!=typeof t)throw new Error("the path must be a string");return function(e,n){request(t,_extends({},n,{method:"DELETE",id:e}))}}function request(t,e){if(void 0!==e.id&&(t=formatUri(t,{id:e.id})),void 0!==e.data&&(t=formatUri(t,e.data)),e.prefix&&(t=prefix+t),e.cache&&request.cache[t]&&!e.force)return Promise.resolve(request.cache[t]);if(!1===e.multiple&&request.queue[t])return request.queue[t];var n={method:e.method,headers:{"Content-Type":"application/json"}};return e.data&&(n.body=JSON.stringify(e.data)),fetcher[t]=fetch(t,n).then(function(t){if(t.ok)return t;throw new Error("bad status code: "+t.status)}).then(function(t){return t.json()}).then(function(t){return e.extract?t[e.extract]:t}).then(function(n){return e.cache&&(request.cache[t]=n),delete request.queue[t],n})}function formatUri(t,e){return t.replace(/:(\w+)/g,function(t,n){return e[n]})}var asyncGenerator=function(){function t(t){this.value=t}function e(e){function n(o,u){try{var i=e[o](u),s=i.value;s instanceof t?Promise.resolve(s.value).then(function(t){n("next",t)},function(t){n("throw",t)}):r(i.done?"return":"normal",i.value)}catch(t){r("throw",t)}}function r(t,e){switch(t){case"return":o.resolve({value:e,done:!0});break;case"throw":o.reject(e);break;default:o.resolve({value:e,done:!1})}(o=o.next)?n(o.key,o.arg):u=null}var o,u;this._invoke=function(t,e){return new Promise(function(r,i){var s={key:t,arg:e,resolve:r,reject:i,next:null};u?u=u.next=s:(o=u=s,n(t,e))})},"function"!=typeof e.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)},{wrap:function(t){return function(){return new e(t.apply(this,arguments))}},await:function(e){return new t(e)}}}(),_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};request.cache={},request.queue={};export{createApi,_list as list,_get as get,_post as post,_put as put,_del as del};
